<!-- Recommendations for Efficiency and Smart Notifications Panel -->
<div class="card mt-4 shadow-sm" id="efficiencyRecommendationsPanel" style="display:none;">
  <div class="card-header bg-white border-bottom">
    <div class="d-flex justify-content-between align-items-center">
      <h5 class="mb-0 d-flex align-items-center gap-2">
        <i class="bi bi-lightbulb-fill text-warning"></i>
        Rekomendasi Efisiensi dan Notifikasi Pintar
      </h5>
      <button class="btn btn-sm btn-outline-secondary" type="button" data-bs-toggle="collapse" data-bs-target="#recommendationsContent" aria-expanded="true">
        <i class="bi bi-chevron-up"></i>
      </button>
    </div>
  </div>
  
  <div class="collapse show" id="recommendationsContent">
    <div class="card-body">
      
      <!-- Cost Weight Recommendation -->
      <div id="costWeightRecommendation" class="mb-4" style="display:none;">
        <div class="alert alert-info mb-0" role="alert">
          <div class="d-flex align-items-start gap-2">
            <i class="bi bi-info-circle-fill fs-5"></i>
            <div class="flex-grow-1">
              <p class="mb-0" id="costWeightRecommendationText"></p>
            </div>
          </div>
        </div>
      </div>

      <!-- Items Not in AHSP Database -->
      <div id="notInDatabaseSection" class="mb-4" style="display:none;">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h6 class="mb-0 d-flex align-items-center gap-2">
            <i class="bi bi-exclamation-triangle-fill text-warning"></i>
            Item Tidak Ditemukan di Database
            <span class="badge bg-warning text-dark" id="notInDatabaseCount">0</span>
          </h6>
        </div>
        <div class="alert alert-warning" role="alert">
          <p class="mb-2"><strong>⚠️ Item berikut tidak dapat diisi otomatis (tidak ditemukan di database):</strong></p>
          <ul id="notInDatabaseList" class="mb-0 ps-3"></ul>
        </div>
      </div>

      <!-- Price Deviations -->
      <div id="priceDeviationSection" class="mb-4" style="display:none;">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h6 class="mb-0 d-flex align-items-center gap-2">
            <i class="bi bi-exclamation-diamond-fill text-danger"></i>
            Peringatan Penyimpangan Harga
            <span class="badge bg-danger" id="priceDeviationCount">0</span>
          </h6>
        </div>
        <div class="table-responsive">
          <table class="table table-sm table-hover align-middle" id="priceDeviationTable">
            <thead class="table-light">
              <tr>
                <th>Nama Item</th>
                <th>Tingkat</th>
                <th class="text-end">Harga Aktual</th>
                <th class="text-end">Harga Referensi</th>
                <th class="text-end">Penyimpangan</th>
                <th>Pesan</th>
              </tr>
            </thead>
            <tbody id="priceDeviationTableBody">
            </tbody>
          </table>
        </div>
      </div>

      <!-- No Warnings State -->
      <div id="noWarningsSection" style="display:none;">
        <div class="alert alert-success mb-0" role="alert">
          <div class="d-flex align-items-center gap-2">
            <i class="bi bi-check-circle-fill fs-5"></i>
            <div>
              <h6 class="alert-heading mb-1">✓ Semua Baik!</h6>
              <p class="mb-0">Tidak ada peringatan atau rekomendasi saat ini. Semua item sudah sesuai dan harga tepat.</p>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<style>
  #efficiencyRecommendationsPanel .card-header {
    background: linear-gradient(135deg, #4c51bf 0%, #5b21b6 100%);
    color: #ffffff;
  }
  
  #efficiencyRecommendationsPanel .card-header h5 {
    color: #ffffff;
  }
  
  #efficiencyRecommendationsPanel .card-header .btn-outline-secondary {
    border-color: rgba(255,255,255,0.5);
    color: #ffffff;
  }
  
  #efficiencyRecommendationsPanel .card-header .btn-outline-secondary:hover {
    background: rgba(255,255,255,0.2);
    border-color: #ffffff;
  }

  .deviation-badge {
    padding: 0.35rem 0.65rem;
    border-radius: 0.375rem;
    font-weight: 600;
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .deviation-moderate {
    background-color: #fff3cd;
    color: #856404;
    border: 1px solid #ffc107;
  }

  .deviation-high {
    background-color: #ffebee;
    color: #c62828;
    border: 1px solid #f44336;
  }

  .deviation-critical {
    background-color: #f8d7da;
    color: #721c24;
    border: 1px solid #dc3545;
    animation: pulse 2s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
  }

  #priceDeviationTable tbody tr:hover {
    background-color: #f8f9fa;
  }
</style>
